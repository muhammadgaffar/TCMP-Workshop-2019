program main
  implicit none


  nparticle = 50
  
  tmin = 0.d0
  tmax = 1.d0
  nt = 100 * nparticle

  dt = (tmax - tmin) / (nt - 1)

  nkiri = nparticle
  do it = 1,nt
     prob_gen  = rand()
     prob_part = dfloat(nkiri) / dfloat(nparticle) 
     if (prob.le.prob_part) then
        nkiri = nkiri - 1
     else
        nkiri = nkiri + 1
     end if

     time = tmin + dt * (i-1)
     
     write(*,*) time, nkiri
  end do       
  
end program main
